(function(){var b,a,i,e,d,l,k,h,j,f,g,c;i='<div class="comment-box" style="display: none">    <div class="comment-internals">        <div>            <p class="comment-author">author</p>            <p class="comment-body">body</p>        </div>        <div>            <p style="text-align: right">                <a href="javascript:void(0)" class="reply">Reply</a>            </p>        </div>    </div></div>';a='<div class="new-comment">    <div class="comment-form">        <p class="alert alert-warning" style="display: none">Something\'s gone wrong, Jim. Please try again in a bit.</p>        <textarea placeholder="Leave a comment" class="comment-field"></textarea>        <div class="comment-slider" style="display: none">            <button class="save-button form-item">Save</button>            <input type="text" placeholder="Name" class="name-field form-item">        </div>    </div></div>';d=function(m){return m.val().length===0};f=function(n,m){if(m===0){return}n.css("position","relative");n.animate({left:"1px"},50).animate({left:"0px"},50);return f(n,m-1)};e=function(m){m.css("border-color","#F44336");return f(m,4)};b=function(n){var m;m=$(i);m.attr("id",n.comment_id);m.find("p.comment-author").text(n.name);m.find("p.comment-body").text(n.body);m.find("a.reply").hide();return m};h=function(m){return 1234};k=function(n,q){var m,p,o;o=n.parents(".comment-box:first");m=b(q);if(o.length!==0){o.find(".comment-internals:first").after(m.prop("outerHTML"))}else{$(".root-comment").prepend(m.prop("outerHTML"))}p=$("#"+q.comment_id);p.next().css({"margin-left":0});return p.fadeIn().find(".comment-author").css("color","#9f5512")};c=function(){var n,m;n=$("#total-comments");m=parseInt(n.text());return n.text(m+1)};g=function(m){var n,o;n=m.parents(".comment-box");if(n.length===0){o=null}else{o=n.attr("id")}return new Promise(function(q,p){return $.ajax("./storecomment/",{type:"POST",data:{parent_id:o,body:m.parent().prev("textarea").val(),name:m.next(".name-field").val(),csrfmiddlewaretoken:l()},xhrFields:{withCredentials:true},beforeSend:function(r){return r.setRequestHeader("X-CSRFToken",l())}}).done(function(r){console.log("success!");return q(r)}).fail(function(r){return p(r)})})};l=function(){var o,q,n,p,m;p=document.cookie.split(";");m=[];for(q=0,n=p.length;q<n;q++){o=p[q];if(o.indexOf("csrftoken")>-1){m.push($.trim(o.split("=")[1]))}}return m};j=function(m){return $(document).on("click",".comment-field, .name-field",function(n){return $(this).css("border-color",m)})};jQuery(function(o){var n,m;n=o(".comment-field");m=n.css("border-color");j(m);n.on("click",function(){return o(this).animate({height:"120px"},"slow").unbind().next(".comment-slider").slideDown()});o(document).on("click",".save-button",function(p){var r,q;p.preventDefault();r=o(this).parents(".new-comment").find("textarea");q=o(this).next(".name-field");if(d(r)){e(r)}if(d(q)){e(q)}if(!d(r)&&!d(q)){return g(o(this)).then((function(s){console.log(s);k(o(p.target),s);c();return setTimeout((function(){return o(p.target).parents(".new-comment").slideUp()}),500)}),(function(){var s;s=o(p.target).parents("div.comment-form").find("p.alert");s.css("display","block");return f(s,2)}))}});return o(".comment-box .reply").on("click",function(){var r,p,q;p=o(this).parents(".comment-internals");q=p.find("p.comment-author");r=o(a);r.appendTo(p);r.find(".comment-field, .name-field").css("border-color",m);r.find("textarea").attr("placeholder","replying to "+q.text()).animate({height:"120px"},"slow");r.find(".comment-slider").slideDown();return o(this).hide()})})}).call(this);